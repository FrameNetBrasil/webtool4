// =============================================================================
// ACCESSIBILITY UTILITIES  
// WCAG 2.1 AA compliant utilities and overrides
// =============================================================================

// -----------------------------------------------------------------------------
// Focus States
// -----------------------------------------------------------------------------

// Enhanced focus indicators
.button:focus,
.input:focus,
.textarea:focus,
.select select:focus,
.dropdown-trigger button:focus {
  box-shadow: 0 0 0 3px rgba(var(--bulma-primary-h), var(--bulma-primary-s), var(--bulma-primary-l), 0.25) !important;
  outline: 2px solid transparent;
  outline-offset: 2px;
}

// Table row focus for keyboard navigation
.table tbody tr:focus {
  background-color: hsl(var(--bulma-primary-h), var(--bulma-primary-s), 95%);
  outline: 2px solid hsl(var(--bulma-primary-h), var(--bulma-primary-s), 70%);
  outline-offset: -2px;
}

// -----------------------------------------------------------------------------
// Screen Reader Utilities
// -----------------------------------------------------------------------------

.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

.sr-only-focusable {
  &:active,
  &:focus {
    position: static !important;
    width: auto !important;
    height: auto !important;
    padding: inherit !important;
    margin: inherit !important;
    overflow: visible !important;
    clip: auto !important;
    white-space: inherit !important;
  }
}

// -----------------------------------------------------------------------------
// High Contrast Mode Support
// -----------------------------------------------------------------------------

@media (prefers-contrast: high) {
  .table {
    border: 2px solid currentColor;
    
    th,
    td {
      border: 1px solid currentColor;
    }
  }
  
  .card {
    border: 2px solid currentColor;
  }
  
  .button {
    border: 2px solid currentColor;
  }
}

// -----------------------------------------------------------------------------
// Reduced Motion
// -----------------------------------------------------------------------------

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  
  .dropdown-menu,
  .modal,
  .app-sidebar {
    transition: none !important;
  }
}

// -----------------------------------------------------------------------------
// Color Contrast Improvements
// -----------------------------------------------------------------------------

// Ensure sufficient contrast for links
a:not(.button) {
  text-decoration-color: currentColor;
  text-underline-offset: 0.125em;
  
  &:hover,
  &:focus {
    text-decoration-thickness: 2px;
  }
}

// Improve contrast for disabled states
.button:disabled,
.input:disabled,
.textarea:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

// Better visibility for selection states
.table tbody tr.is-selected {
  background-color: hsl(var(--bulma-primary-h), var(--bulma-primary-s), 90%) !important;
  color: hsl(var(--bulma-primary-h), var(--bulma-primary-s), 20%) !important;
  border: 2px solid hsl(var(--bulma-primary-h), var(--bulma-primary-s), 60%);
}

// -----------------------------------------------------------------------------
// Keyboard Navigation
// -----------------------------------------------------------------------------

// Skip link for main content
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: $primary;
  color: $white;
  padding: 8px;
  z-index: 1000;
  text-decoration: none;
  border-radius: $radius;
  
  &:focus {
    top: 6px;
  }
}

// Better focus indicators for interactive elements
.menu-link:focus,
.navbar-item:focus {
  background-color: hsl(var(--bulma-primary-h), var(--bulma-primary-s), 95%);
  outline: 2px solid hsl(var(--bulma-primary-h), var(--bulma-primary-s), 70%);
  outline-offset: -2px;
}

// -----------------------------------------------------------------------------
// ARIA Live Regions
// -----------------------------------------------------------------------------

.live-region {
  position: absolute !important;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
  
  &[aria-live="polite"],
  &[aria-live="assertive"] {
    position: static !important;
    left: auto;
    width: auto;
    height: auto;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }
}

// -----------------------------------------------------------------------------
// Form Accessibility
// -----------------------------------------------------------------------------

// Required field indicators
.field .label .is-required::after {
  content: " *";
  color: $danger;
  font-weight: bold;
}

// Error states with better contrast
.input.is-danger,
.textarea.is-danger {
  border-color: $danger;
  box-shadow: inset 0 1px 2px rgba($danger, 0.1);
}

.help.is-danger {
  color: $danger;
  font-weight: 600;
}